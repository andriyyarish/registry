<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title th:utext="${title}"></title>
  <link href='https://fonts.googleapis.com/css?family=Ubuntu' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>

  <!--    <script th:src="@{/webjars/jquery/3.3.1/jquery.min.js}"></script>-->
  <!--    <link rel="stylesheet" th:href="@{/webjars/bootstrap/4.3.0/css/bootstrap.min.css}"/>-->
  <!--    <script th:src="@{/webjars/bootstrap/4.3.0/js/bootstrap.min.js}"></script>-->

  <link th:href="@{/css/bootstrap.css}" rel="stylesheet">
  <link th:href="@{/css/mdb.css}" rel="stylesheet">

  <script type="text/javascript" charset="utf8" th:src="@{/js/jquery-3.3.1.min.js}"></script>
  <script type="text/javascript" charset="utf8" th:src="@{/js/popper.min.js}"></script>
  <script type="text/javascript" charset="utf8" th:src="@{/js/bootstrap.js}"></script>
</head>

<body class="blue-gradient">


<!-- Include menu.html -->
<th:block th:include="menu"></th:block>

<div class="container-fluid">

  <div class="row mt-3">
    <div class="col-md-8">
      <div class="elegant-color-dark text-white">
        <h1>Обновлення даних по договору</h1>
      </div>
      <div class="container blue-grey lighten-5">
        <form class="md-form needs-validation"
              th:action="@{/contract/{id}/update(id=${contract.getId()})}"
              th:object="${updatedContractForm}"
              method="POST" enctype="multipart/form-data" novalidate>
          <h1>Замовник</h1>
          <div class="form-row">
            <div class="md-form">
              <input type="text" class="form-control" id="customerName"
                     th:value="${contract.getCustomer().getOrgName()}" disabled/>
              <label for="customerName">Замовник:</label>
            </div>
            <div class="md-form">
              <input type="tel" class="form-control" id="customerPhone"
                     th:value="${contract.getCustomer().getPhone()}" disabled/>
              <label for="customerPhone">Тел. Замовника:</label>
            </div>
          </div>
          <h1>Ділянка</h1>
          <div class="form-row">
            <div class="md-form">
              <input type="text" class="form-control" id="region"
                     th:value="${contract.getRegion()}"
              />
              <label for="region">Район: </label>
            </div>
            <div class="md-form">
              <input type="text" class="form-control" id="village"
                     th:value="${contract.getVillageCouncil()}"
              />
              <label for="village">Село: </label>
            </div>
            <div class="md-form">
              <input type="text" class="form-control" id="square"
                     th:value="${contract.getSquare()}"
              />
              <label for="square">Площа ділянки: </label>
            </div>
          </div>
          <div class="md-form">
            <input class="form-control" id="type" th:value="${contract.orderType}" disabled></input>
            <label for="type" class="col-form-label">Type:</label>
          </div>
          <div class="md-form">
            <label for="status" class="col-form-label">Status:</label>
            <select class="mdb-select" id="status" th:name="status" searchable="Пошук..">
              <option th:each="s : ${statusOptions}" th:value="${s.getLabel()}"
                      th:text="${s.getLabel()}"
                      th:selected="${#strings.equals(s.getLabel(), contract.getOrderStatus())}">
            </select>
          </div>
          <div class="md-form">
            <label for="stage" class="col-form-label">Stage:</label>
            <select class="mdb-select" id="stage" th:name="stage" searchable="Пошук..">
              <option th:each="s : ${stagesOptions}" th:value="${s.getLabel()}"
                      th:text="${s.getLabel()}"
                      th:selected="${#strings.equals(s.getLabel(), contract.getStage())}">
            </select>
          </div>

          <div class="row">
            <div class="md-form col">
              <label for="price" class="col-form-label">Price: </label>
              <input type="number" class="form-control" id="price"
                     th:value="${contract.getTotalPrice()}"
                     disabled>
            </div>
            <div class="md-form col">
              <label for="debt" class="col-form-label">Debt:</label>
              <input type="number" class="form-control" id="debt"
                     th:value="${contract.payedAmount} - ${contract.getTotalPrice()}" disabled
                     th:classappend="(${contract.payedAmount} - ${contract.getTotalPrice()}) < 0 ? bg-warning : bg-success">
            </div>
            <div class="md-form col">
              <label for="payedAmount" class="col-form-label">Payed amount:</label>
              <input type="number" class="form-control" id="payedAmount" th:field="*{payedAmount}">
            </div>
          </div>

          <div class="md-form input-group">
            <div class="input-group-prepend">
              <span class="input-group-text md-addon mr-2">Відповідальний: </span>
            </div>
            <select id="responsible" th:name="assignedTo" class="mdb-select">
              <option th:each="u : ${employee}" th:value="${u.getUsername()}"
                      th:text="${u.getUsername()}"
                      th:selected="${#strings.equals(u.getUsername(), contract.getAssignedTo().getUsername())}">
            </select>
          </div>


          <div class="file-field col-md-6">
            <div class="btn btn-primary btn-sm float-left">
              <span>Виберіть файли</span>
              <input type="file" th:field="*{customerDocument}">
            </div>
            <div class="file-path-wrapper">
              <input class="file-path validate" type="text"
                     placeholder="Дані про ділянку">
            </div>
          </div>

          <div class="md-form">
            <label for="isFinished" class="col-form-label checkbox-inline">Is Contract finished:
              <input class="checkbox" type="checkbox" id="isFinished" disabled
                     th:checked="${contract.isFinished()}"/>
            </label>
          </div>

          <div class=" row">
            <div class="col-md-4">
              <a th:href="@{/contract/{id}/close(id=${contract.getId()})}" class="btn btn-danger"
                 name="close">Close&Archive</a>
            </div>
            <div class="col-md-3"></div>
            <div class="col-md-4">
              <button type="submit" class="btn btn-primary">Submit</button>
            </div>

          </div>
        </form>
      </div>
    </div>
    <div class="col-md-4">
      <div>
        <h1 class="elegant-color-dark text-white">Історія змін</h1>
        <button data-toggle="collapse" data-target="#log" class="btn btn-info btn-block">Show Log
        </button>
      </div>
      <div class="blue-grey lighten-5">
        <div class="list-group collapse" id="log" th:each="log: ${contract.getLog()}">
                <span class="list-group-item list-group-item-info disabled"
                      th:utext="${log.getMessage()}">Message</span>
        </div>
      </div>
    </div>
  </div>
  <div class="row mt-3">
    <div class="col-md-8">
      <div class="elegant-color-dark text-white">
        <h2>Список прикріплених файлів</h2>
      </div>
      <div class="container blue-grey lighten-5">
        <div class="list-group" th:each="file : ${files}">
          <a class="list-group-item list-group-item-action" th:href="${file.getKey()}"
             th:text="${file.getValue()}"/>
        </div>
      </div>
    </div>
  </div>

</div>

<script type="text/javascript" charset="utf8" th:src="@{/js/mdb.js}"></script>
<script type="text/javascript" charset="utf8" th:src="@{/js/modules/mdb-autocomplete.js}"></script>
<script type="text/javascript" charset="utf8" th:src="@{/js/modules/material-select.js}"></script>
ё
<script>
    new WOW().init();




</script>
<script>
    $(document).ready(function () {
        $('.mdb-select').materialSelect();
    });




</script>
</body>
</html>